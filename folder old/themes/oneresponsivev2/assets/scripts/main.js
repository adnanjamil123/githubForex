$(document).ready(function(){searchBox();var rightColumnSignUp=new SignUp();contactOFM();riskFooter();locationsFooter();playBannerVideo();privacynoticeToggle();toolTipEnabler();fixedTableHeader();clientPortalDropDown();});function clientPortalDropDown(){$('.ClientPortalbtn-cn').click(function(e){console.log($(this));$('.clientportallist').toggleClass('hidden');});}
function privacynoticeToggle(){$('.privacy-notice-toggler a').click(function(e){e.preventDefault();$('.privacy-notice-body').stop().slideToggle();$('.privacy-notice-toggler').toggleClass('open');});}
function fixedTableHeader()
{if($('.scroll-fixed-header').length&&$('#header-fixed').length){var tableOffSet=$('.scroll-fixed-header').offset().top;var tableheader=$('.scroll-fixed-header > thead').clone();var fixedHeader=$('#header-fixed').append(tableheader);$(window).bind("scroll",function(){var offset=$(this).scrollTop();if(offset>=tableOffSet&&fixedHeader.is(":hidden")){fixedHeader.show();$('#header-fixed').addClass('display-block');}
else if(offset<tableOffSet){fixedHeader.hide();$('#header-fixed').removeClass('display-block');}});}}
function toolTipEnabler(){$('input.email').click(function(){if($(this).is(":focus")){$('.newtooltip.email').addClass('visible');}});$('input.phone').click(function(){if($(this).is(":focus")){$('.newtooltip.phone').addClass('visible');}});$("input.email").blur(function(){$('.newtooltip.email').removeClass('visible');});$("input.phone").blur(function(){$('.newtooltip.phone').removeClass('visible');});}
function playBannerVideo(){if($('.video-slider-item video').length>0){$('.video-slider-item video').get(0).play();}}
function CSPlayJsAdPopWin(){var qq_chat=true;if(qq_chat){window.location.href="http://wpa.b.qq.com/cgi/wpa.php?ln=1&key=XzgwMDAxMzcyOF80NTc2NDZfODAwMDEzNzI4XzJf";}};function locationsFooter(){footerSetUpAddresses();footerSetUpLinks();}
function footerSetUpLinks(){$onet=$("#office-network .links");$onet.find(".flag").each(function(index){$(this).click(function(e){$('footer .contact-details .flag').hide();$a=$(this).attr('class').split(' ');$('footer .contact-details').find("."+$a[2]).show();});})}
function footerSetUpAddresses(){$onet=$("#office-network .links");var x=0;$('footer .locations .flag').each(function(index){$onet.append("<li class='"+$(this).attr('class')+"'>"+$(this).find('span.title').html()+"</li>");if(x>0){$(this).hide();}
x++;})}
function resizeIframe(obj){obj.style.height=obj.contentWindow.document.body.scrollHeight+'px';}
if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');}}
function SignUp(){this.init=function(){this.prepDropDown();}
this.prepDropDown=function(){$("#right_account_type").change(function(){var sel=$(this).find("option:selected").val();$(".right_account_forms").hide();if(sel=="demo_account"){$("#actualDemoForm").show();}
else if(sel=="live_account"){$("#actualLiveForm").show();}});}
this.init();}
function contactOFM(){if($("#mkForm").length>0){$("#mkForm").validate({submitHandler:function(form){var num=1347;$('#UserAccount').val(num);form.submit();}});}}
var sTitle=sTitle||"Search";function searchBox(){if($(".searchInput").val()==""){$(".searchInput").val(sTitle);}
$(".searchInput").focus(function(){if(($(this).val()==sTitle)){$(this).val("");$(this).addClass("selected");}});$(".searchInput").blur(function(){if(($(this).val()=="")){$(this).val(sTitle);$(this).removeClass("selected");}});}
$(document).ready(function(){prepareSlideMenu();cmPrepAllSubs();});var tmpSelectedSub;var qInterval;var navSelected=-1;var macFirstLoad=0;var featureMap={};var sir="ltr";function cmPrepAllSubs(){var $=jQuery;if($("html").attr("dir")!=null){txtDir=$("html").attr("dir");}
console.log($('#primaryNav ul.menu ul.menu'));$('#primaryNav ul.menu ul.menu').wrap("<div class='secondary-mega'>");$("#primaryNav ul.menu li a").attr("title","");$('#primaryNav div.secondary-mega').wrapInner("<div class='contai'>");$('#primaryNav div.secondary-mega ul.menu').wrap("<div class='left-mega'>");$('#primaryNav div.secondary-mega ul').removeClass("menu");$('#primaryNav div.secondary-mega .contai').append("<div class='navclear clearfix'></div>");$("#primaryNav ul.menu li a").each(function(index){$(this).attr('id','primaryitem_'+index);$(this).parent().find("div.secondary-mega").attr('id','secondaryNav_'+index);});$('#primaryNav').after("<div id='secondary-mega-container'></div>");$('#secondary-mega-container').append($('#primaryNav div.secondary-mega'));$("#primaryNav ul.menu .inner-mega-menu").each(function(index){var id=$(this).parent().find("a").eq(0).attr('id');var top="primaryitem_";id=id.substr(top.length);$('#secondaryNav_'+id+' .navclear').remove();$('#secondaryNav_'+id+' .contai').append("<div class='focus-mega'></div>");$('#secondaryNav_'+id+' .contai').append("<div class='clearfix'></div>");var intro=$(this).find(".views-field-field-mega-introduction .field-content").html();var feature=$(this).find(".views-field-field-mega-menu .field-content").html();if(feature!=null&&feature.length>0){featureMap[id]=feature;$("#secondaryNav_"+id+" .focus-mega").prepend(feature);}
$("#secondaryNav_"+id+" .left-mega").prepend(intro);});$('#primaryNav ul.menu li a').mouseover(function(){selectNavSub($(this),1);});$('#primaryNav ul.menu li a').mouseout(function(){qInterval=setInterval("hideNavSubs()",250);});$('.secondary-mega').mouseover(function(){clearInterval(qInterval);});$('.secondary-mega').mouseout(function(){qInterval=setInterval("hideNavSubs()",250);});$(".secondary-mega .readmore").each(function(index){var href=$(this).attr("href");$(this).closest(".focus-mega").mouseover(function(){$(this).closest(".contai").addClass("selected");});$(this).closest(".focus-mega").click(function(){window.open(href,'_top');});$(this).closest(".focus-mega").mouseout(function(){$(this).closest(".contai").removeClass("selected");});});redrawNavigation();}
$(window).on("resize",function(){redrawNavigation();});function redrawNavigation(){var $=jQuery;$("#primaryNav ul.menu li a").each(function(index){var top="primaryitem_";var id=$(this).attr('id');id=id.substr(top.length);var hPri=$("#primaryNav").innerHeight();$("#secondaryNav_"+id).css("top",$(this).position().top+hPri-7);var contNavWidth=$("#primaryNavContainer").width();var priWidth=$("#primaryNav").width();var secWidth=$("#secondaryNav_"+id).width();if(txtDir=="ltr"){var secondaryNavLeft=$(this).position().left-5;if((secondaryNavLeft+secWidth)>priWidth){$("#secondaryNav_"+id).css("left",priWidth-secWidth);}
else{$("#secondaryNav_"+id).css("left",secondaryNavLeft-3);}}
else{if($("#secondaryNav_"+id).length){var secondaryNavLeft=$(this).position().left;var secondaryNavWidth=$(this).outerWidth();var $secondaryNav=$("#secondaryNav_"+id);var secondNavLeftPosition=(((secondaryNavLeft+secondaryNavWidth)-secWidth)+(contNavWidth-priWidth));$secondaryNav.css("left",secondNavLeftPosition);if(secondNavLeftPosition>(contNavWidth-secWidth-7)){$secondaryNav.css("left",contNavWidth-secWidth-7);}}}});}
function selectNavSub(plink,subShow){var $=jQuery;clearInterval(qInterval);hideNavSub(tmpSelectedSub);var top="primaryitem_";var id=plink.attr('id');if(id!=undefined){id=id.substr(top.length);tmpSelectedSub=id;$("#primaryitem_"+id).addClass("selected");if(subShow==1){var $subNav=$("#secondaryNav_"+id);if($subNav.exists()){$("#primaryNav #primaryitem_"+(id-1)).addClass("selectedRight");$("#primaryNav #primaryitem_"+id).addClass("selectedSub");$("#secondaryNav_"+id).stop(false,false).show();}}}}
function hideNavSub(id){var $=jQuery;$("#primaryitem_"+(id-1)).removeClass("selectedRight");$("#primaryitem_"+id).removeClass("selectedSub");$("#primaryitem_"+id).removeClass("selected");$("#secondaryNav_"+id).hide();}
function hideNavSubs(){var $=jQuery;clearInterval(qInterval);$("#primaryNav li a").each(function(index){var top="primaryitem_";var id=$(this).attr('id');id=id.substr(top.length);hideNavSub(id);});}
jQuery.fn.exists=function(){return this.length>0;}
function prepareSlideMenu(){var navLang=$('html').attr('lang');try{$('#slide-nav .container').append($('<div id="navbar-height-col"></div>'));$('#slidemenu').html("<div>"+$('#primaryNav').html()+"</div>");var searchbox="<input type='text' name='searchstring' value='' placeholder='"+this.searchTitle+"' class='form-control'><span class='input-group-btn'><button class='btn btn-success' type='submit'><i class='fa fa-search fa-fw'></i></button></span>";if(navLang=="ar"){searchbox="<span class='input-group-btn'><button class='btn btn-success' type='submit'><i class='fa fa-search fa-fw'></i></button></span><input type='text' name='searchstring' value='' placeholder='"+this.searchTitle+"' class='form-control' dir='rtl'>";}
$('#slidemenu').prepend("<div class='mobile-search'><form method='get' action='/search/node'><div class='input-group'>"+searchbox+"</div></form></div>");$('#slidemenu').append($('.menu-top-secondary div.menu').html());if(navLang=="ar"){$('#slide-nav').hide();}
var toggler='.navbar-toggle';var pagewrapper='#page-content';var navigationwrapper='.navbar-header';var slidewidth='80%';var menuneg='-100%';var slideneg='-80%';$("header").on("click",toggler,function(e){var selected=$(this).hasClass('slide-active');var se1=$('#slidemenu').stop().animate({left:selected?menuneg:'0px'});var se2=$('#navbar-height-col').stop().animate({left:selected?slideneg:'0px'});var se3=$(pagewrapper).stop().animate({left:selected?'0px':slidewidth});var se4=$(navigationwrapper).stop().animate({left:selected?'0px':slidewidth});$(this).toggleClass('slide-active',!selected);$('#slidemenu').toggleClass('slide-active');$('#page-content, .navbar, body, .navbar-header').toggleClass('slide-active');if(navLang=="ar"){if(selected){$.when(se1,se2,se3,se4).done(function(){$('#slide-nav').hide();});}
else{$('#slide-nav').show();}}});var selected='#slidemenu, #page-content, body, .navbar, .navbar-header .fasttracks, header .chat-links';$(".menu-top-secondary .container .fasttracks").html($("header .fasttracks").html()+"<div class=\"clearfix\"></div>");$(".menu-top-secondary .container .chat-links").html($("header .chat-links").html()+"<div class=\"clearfix\"></div>");if(navLang!="ar"){$(window).on("resize",function(){if($(window).width()>767&&$('.navbar-toggle').is(':hidden')){$(selected).removeClass('slide-active');$('#slide-nav').hide();}
if($(window).width()<767&&$('.navbar-toggle').is(':visible')){$(selected).addClass('slide-active');$('#slide-nav').show();}});}
$("#slidemenu ul.menu li.expanded a, #slidemenu nav ul a").each(function(i){if(navLang!='ar'){$(this).prepend("<span class='link-arrow'><i class='fa fa-chevron-right' aria-hidden='true'></i></span>");}
else{$(this).prepend("<span class='link-arrow'><i class='fa fa-chevron-left' aria-hidden='true'></i></span>");}
$(this).find("span.link-arrow").click(function(){window.location=$(this).closest("a").attr('href');});});$("#slidemenu ul.menu li.expanded").each(function(i){$(this).find("a:first").click(function(event){event.preventDefault();$(this).closest(".expanded")
$p=$(this).parent().find('ul.menu');$p.slideToggle();});$(this).find("a .link-arrow").click(function(event){});});var h=$('#primaryNavRight').html();$('#slidemenu').prepend("<div class='mobile-nav-right'>"+h+"<div class='clearfix'></div><div>");$('#slidemenu').append("<div class='mobile-nav-bottom-right'>"+h+"<div class='clearfix'></div><div>");$('#slidemenu').find('#languageDrop').attr('id','languageDrop1');$('.mobile-nav-right .downloadMT4Container').remove();$('.mobile-nav-right .liveChatContainer').remove();$('.mobile-nav-bottom-right .languages').remove();var oHandler1=$("#languageDrop1").msDropDown().data("dd");}
catch(error){throw error;}}
jQuery(document).ready(function(){oHandler=$("#languageDrop").msDropDown().data("dd");})
$(document).ready(function(){$(".toggle_container").hide();$("p.trigger").click(function(){$(this).toggleClass("active").next().slideToggle(350);});$(".toggle_container2").hide();$("p.trigger2").click(function(){$(this).toggleClass("active2").next().toggle();});$('.acc_container').hide();$('.acc_trigger').click(function(){if($(this).next().is(':hidden')){$('.acc_trigger').removeClass('active').next().slideUp();$(this).toggleClass('active').next().slideDown();}else{$(this).toggleClass('active').next().slideUp();}
return false;});$('.acc_container2').hide();$('.acc_trigger2').click(function(){if($(this).next().is(':hidden')){$('.acc_trigger2').removeClass('active2').next().slideUp();$(this).toggleClass('active2').next().slideDown();}else{$(this).toggleClass('active2').next().slideUp();}
return false;});});function cmDebug(isItOn){if(isItOn){$("body").prepend('<div id="cmDebug"></div>');}}
function cmPrint(msg){$("#cmDebug").prepend(msg+"<br/>");}
$(window).load(function(){var $=jQuery;$.getScript(chatjs);});jQuery(function($){cmDebug(false);});function rCookie(name){var cVal="",end,srch=name+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(srch);if(offset!=-1){offset+=srch.length;end=document.cookie.indexOf(";",offset);if(end==-1)end=document.cookie.length;cVal=unescape(document.cookie.substring(offset,end));}}
return cVal;}
function wCookie(name,value,hours){var expire="";if(hours!=null){expire=new Date((new Date()).getTime()+hours*3600000);expire=";expires="+expire.toGMTString();}
var strCookie=name+"="+escape(value)+expire+";path=/";document.cookie=strCookie;}
function eCookie(name){var strCookie=name+"=null;expires=Sat, 01-Jan-1970 00:00:00 GMT"+";path=/";document.cookie=strCookie;}
function addEvent(elm,evType,fn,useCapture){if(elm.addEventListener){elm.addEventListener(evType,fn,useCapture);return true;}else if(elm.attachEvent){var r=elm.attachEvent('on'+evType,fn);return r;}else{elm['on'+evType]=fn;}}
var host=window.location.hostname.replace(/[^a-zA-Z0-9]/g,"-");var privacy_notification;if(/loaded|complete/.test(document.readyState)){privacy_notification=new cn({barHeight:50,barHtml:cookieMessage,barMore:cookieMore});}
addEvent(window,"load",function(){privacy_notification=new cn({barHeight:60,barHtml:cookieMessage});},false);function cn(vars){wCookie("OFMCookiesAccepted","y",1);this.SUPPORT_COOKIES=(rCookie("OFMCookiesAccepted")=="y");if(!this.SUPPORT_COOKIES){return;}
if(vars.barHtml==""){return;}
var default_cookie="false$0$"+new Date().toString();function modes(){this.EVERY_PAGE=101;this.FIRST_PAGE=102;this.N_VISITS=103;}
MODES=new modes();this.MODE=MODES.FIRST_PAGE;this.MAX_SHOWS=3;this.MIN_TIME_BETWEEN=30;this.COOKIE_NAME="nw_eu_privacy";this.COOKIE=rCookie(this.COOKIE_NAME);this.VALID_COOKIE=this.COOKIE.split("$").length==3;this.HAS_CLICKED=(this.VALID_COOKIE)?(this.COOKIE.split("$")[0]=="true"?true:false):false;this.TIMES_SHOWN=(this.VALID_COOKIE)?parseInt(this.COOKIE.split("$")[1]):0;this.NEXT_SHOWN=(this.VALID_COOKIE)?new Date(this.COOKIE.split("$")[2]):new Date();this.formatCookie=function(clicked,times,next){return clicked+"$"+times+"$"+next;}
this.updateHasClicked=function(state){wCookie(this.COOKIE_NAME,this.formatCookie("true",this.TIMES_SHOWN,this.NEXT_SHOWN.toString()),24*730);this.refreshCookie();}
this.incrementTimesShown=function(){var n=this.TIMES_SHOWN;n++;wCookie(this.COOKIE_NAME,this.formatCookie(this.HAS_CLICKED,n,this.NEXT_SHOWN.toString()),24*730);this.refreshCookie();}
this.updateNextShown=function(){var next=new Date();next.setMinutes(next.getMinutes()+this.MIN_TIME_BETWEEN);wCookie(this.COOKIE_NAME,this.formatCookie(this.HAS_CLICKED,this.TIMES_SHOWN,next.toString()),24*730);this.refreshCookie();}
this.refreshCookie=function(){this.COOKIE=rCookie(this.COOKIE_NAME);this.VALID_COOKIE=this.COOKIE.split("$").length==3;this.HAS_CLICKED=(this.VALID_COOKIE)?(this.COOKIE.split("$")[0]=="true"?true:false):false;this.TIMES_SHOWN=(this.VALID_COOKIE)?parseInt(this.COOKIE.split("$")[1]):1;this.NEXT_SHOWN=(this.VALID_COOKIE)?new Date(this.COOKIE.split("$")[2]):new Date();}
this.createCookie=function(){wCookie(this.COOKIE_NAME,default_cookie,24*730);this.refreshCookie();if(typeof(privacy_notification_firstdisplay)=="function"){privacy_notification_firstdisplay(this);}}
this.doNoticeReadAction=function(){this.remove();if(typeof(privacy_notification_moreinfo)=="function"){privacy_notification_moreinfo(this);}}
this.doNoticeCloseAction=function(){this.remove();if(typeof(privacy_notification_close)=="function"){privacy_notification_close(this);}}
this.remove=function(){this.updateHasClicked();if(typeof(jQuery)!="undefined"){jQuery("body").animate({marginTop:"0px","margin-top":"0px"},{duration:800,queue:false,complete:function(){jQuery("#cn").animate({"height":"0px"},{duration:100,queue:false,complete:function(){jQuery("#cn").hide();}});}});}else{document.getElementById("cn").style.display="none";document.getElementById("cn").style.height="0px";document.body.style.marginTop="0px";}}
this.appendStyles=function(){document.getElementsByTagName('html')[0].style.background="#fff";var eu_css="#cn{top:-"+vars.barHeight+"px;}";var eu_style=document.createElement("style");eu_style.type="text/css";var rules=document.createTextNode(eu_css);if(eu_style.styleSheet){eu_style.styleSheet.cssText=rules.nodeValue;}else{eu_style.appendChild(rules);}
document.getElementsByTagName('head')[0].appendChild(eu_style);}
this.Insert=function(){if(typeof(jQuery)!="undefined"){jQuery("body").css("position","relative");jQuery("body").prepend("<div id=\"cn\"></div>");jQuery("#cn").html(jQuery("#cookie-bar").html());jQuery("#cn").animate({"height":vars.barHeight},{duration:100,queue:false,complete:function(){jQuery("body").animate({marginTop:vars.barHeight,"margin-top":vars.barHeight},{duration:800,queue:false});}});var _this=this;jQuery("#cnMoreInfo").click(function(e){_this.doNoticeReadAction();});jQuery("#cnClose").click(function(e){e.preventDefault();_this.doNoticeCloseAction();});}else{document.body.style.position="relative";var cn=document.createElement("div");cn.id="cn";cn.style.height=parseInt(vars.barHeight)+"px";var cnContent=document.createElement("div");cnContent.id="cnContent";cnContent.innerHTML=vars.barHtml;document.body.style.marginTop=parseInt(vars.barHeight)+"px";cn.appendChild(cnContent);document.body.appendChild(cn);var _this=this;document.getElementById("cnMoreInfo").onclick=function(){_this.doNoticeReadAction();}
document.getElementById("cnClose").onclick=function(){_this.doNoticeCloseAction();return false;}}}
if(this.SUPPORT_COOKIES){if(!this.VALID_COOKIE){this.createCookie();}
if(!this.HAS_CLICKED){switch(this.MODE){case MODES.EVERY_PAGE:this.appendStyles();this.Insert();break;case MODES.FIRST_PAGE:if(new Date()>this.NEXT_SHOWN){this.appendStyles();this.Insert();this.updateNextShown();}
break;case MODES.N_VISITS:if(new Date()>this.NEXT_SHOWN){if(this.TIMES_SHOWN<this.MAX_SHOWS){this.appendStyles();this.Insert();this.incrementTimesShown();this.updateNextShown();}}
break;default:break;}}}};(function($){var h=$.scrollTo=function(a,b,c){$(window).scrollTo(a,b,c)};h.defaults={axis:'xy',duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:true};h.window=function(a){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var a=this,isWin=!a.nodeName||$.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!isWin)return a;var b=(a.contentWindow||a).document||a.ownerDocument||a;return/webkit/i.test(navigator.userAgent)||b.compatMode=='BackCompat'?b.body:b.documentElement})};$.fn.scrollTo=function(e,f,g){if(typeof f=='object'){g=f;f=0}if(typeof g=='function')g={onAfter:g};if(e=='max')e=9e9;g=$.extend({},h.defaults,g);f=f||g.duration;g.queue=g.queue&&g.axis.length>1;if(g.queue)f/=2;g.offset=both(g.offset);g.over=both(g.over);return this._scrollable().each(function(){if(!e)return;var d=this,$elem=$(d),targ=e,toff,attr={},win=$elem.is('html,body');switch(typeof targ){case'number':case'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=$(targ,this);if(!targ.length)return;case'object':if(targ.is||targ.style)toff=(targ=$(targ)).offset()}$.each(g.axis.split(''),function(i,a){var b=a=='x'?'Left':'Top',pos=b.toLowerCase(),key='scroll'+b,old=d[key],max=h.max(d,a);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(g.margin){attr[key]-=parseInt(targ.css('margin'+b))||0;attr[key]-=parseInt(targ.css('border'+b+'Width'))||0}attr[key]+=g.offset[pos]||0;if(g.over[pos])attr[key]+=targ[a=='x'?'width':'height']()*g.over[pos]}else{var c=targ[pos];attr[key]=c.slice&&c.slice(-1)=='%'?parseFloat(c)/100*max:c}if(g.limit&&/^\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&g.queue){if(old!=attr[key])animate(g.onAfterFirst);delete attr[key]}});animate(g.onAfter);function animate(a){$elem.animate(attr,f,g.easing,a&&function(){a.call(this,e,g)})}}).end()};h.max=function(a,b){var c=b=='x'?'Width':'Height',scroll='scroll'+c;if(!$(a).is('html,body'))return a[scroll]-$(a)[c.toLowerCase()]();var d='client'+c,html=a.ownerDocument.documentElement,body=a.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[d],body[d])};function both(a){return typeof a=='object'?a:{top:a,left:a}}})(jQuery);function fbs_click(){u=location.href;t=document.title;window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(u)+'&t='+encodeURIComponent(t),'sharer','toolbar=0,status=0,width=626,height=436');return false;}
function riskFooter(){var $=jQuery;$('.risk-footer .close').click(function(){$(".risk-footer").fadeOut();$.cookie("risk-footer",2,{expires:365,path:'/'});});var coo=$.cookie("risk-footer");if(coo==2){$('.risk-footer').hide();}}
(function(){$(document).ready(function(){var campaign=getCampaign();if(typeof campaign==='object'){$('form.contact-form').each(generateCampaignAdder(campaign));}});function getCampaign(){var params={medium:'',source:'',campaign:'',content:'',term:'',};for(param in params){params[param]=extractURLParameter('utm_'+param);}
if(params.medium&&params.source&&params.campaign){$.cookie('campaign',JSON.stringify(params),{expires:730,path:'/'});}else{params=$.cookie('campaign');if(params){params=JSON.parse(params);}}
return params;}
function extractURLParameter(param){var value=RegExp('[?&]'+param+'=(.*?)(&|$)').exec(document.location.search);return $.isArray(value)?value[1]:'';}
function generateCampaignAdder(campaign){return function(){var form=$(this);var campaign_map={medium:'mkt_medium_c',source:'mkt_source_c',campaign:'mkt_campaign_c',content:'mkt_content_c',term:'mkt_term_c'};for(field in campaign_map){var input=$('<input>');input.attr('type','hidden');input.attr('name','Leads*'+campaign_map[field]);input.attr('value',campaign[field]);form.append(input);}};}})();$(document).ready(function(){$('.vr-overlay button').click(function(e){$('.vr-overlay').hide(1000);});});(function(){$(document).ready(function(){var campaign=getCBCampaign();if(typeof campaign==='object'){$('form.contact-form').each(generateCBCampaignAdder(campaign,"cb_"));$('form.live-contact-form').each(generateCBCampaignAdder(campaign,""));}
updateLiveApplicationLinks();});function updateLiveApplicationLinks(){var links=["https://accounts.onefinancialmarkets.com/live-account/","https://accounts.onefinancialmarkets.me/live-account/","https://apac.onefinancialmarkets.com/live-account/","https://accounts.ofmchina.com/live-account/","http://accounts.one/live-account/"]
$('a').each(function(index,$link){var href=$(this).attr('href');if(arrayStartsWith(href,links)){$(this).attr('href',alterLiveApplicationLink(href));}});$('form.live-contact-form').each(function(index,$link){var href=$(this).attr('action');if(arrayStartsWith(href,links)){$(this).attr('action',alterLiveApplicationLink(href));}});}
function alterLiveApplicationLink(href){var fullURL=href;var urlBits=fullURL.split("?");if(fullURL.indexOf("?")>-1){var urlBits=fullURL.split("?");var pageURLBit=urlBits[0];var stringQBit=urlBits[1];}else{var urlBits=fullURL.split("?");var pageURLBit=urlBits[0];var stringQBit="";}
var outLink="";params=$.cookie('cb_campaign');if(params){params=JSON.parse(params);var i=0;for(var key in params)
{if(params[key]!=""){var q="&";if(i==0){q="";}
outLink=outLink+q+key+"="+params[key];}
i++;}}
outLink=pageURLBit+"?"+outLink+"&"+stringQBit;return outLink;}
if(!String.prototype.startsWith){(function(){'use strict';var defineProperty=(function(){try{var object={};var $defineProperty=Object.defineProperty;var result=$defineProperty(object,object,object)&&$defineProperty;}catch(error){}
return result;}());var toString={}.toString;var startsWith=function(search){if(this==null){throw TypeError();}
var string=String(this);if(search&&toString.call(search)=='[object RegExp]'){throw TypeError();}
var stringLength=string.length;var searchString=String(search);var searchLength=searchString.length;var position=arguments.length>1?arguments[1]:undefined;var pos=position?Number(position):0;if(pos!=pos){pos=0;}
var start=Math.min(Math.max(pos,0),stringLength);if(searchLength+start>stringLength){return false;}
var index=-1;while(++index<searchLength){if(string.charCodeAt(start+index)!=searchString.charCodeAt(index)){return false;}}
return true;};if(defineProperty){defineProperty(String.prototype,'startsWith',{'value':startsWith,'configurable':true,'writable':true});}else{String.prototype.startsWith=startsWith;}}());}
function arrayStartsWith(needle,arr){for(var i in arr)
{if(needle!=null){if(needle.startsWith(arr[i])){return true;}}}
return false;}
function getCBCampaign(){var params={utm_medium:'',utm_source:'',utm_campaign:'',utm_content:'',utm_term:'',link_id:'',referral_id:'',campaign_id:'',semp_id:'',cb:'',};for(param in params){params[param]=extractURLParameter(param);}
console.log(JSON.stringify(params));if(params.link_id||params.referral_id||params.campaign_id||params.utm_medium||params.utm_source||params.utm_campaign||params.cb){$.cookie('cb_campaign',JSON.stringify(params),{expires:730,path:'/'});}else{params=$.cookie('cb_campaign');if(params){params=JSON.parse(params);}}
return params;}
function extractURLParameter(param){var value=RegExp('[?&]'+param+'=(.*?)(&|$)').exec(document.location.search);return $.isArray(value)?value[1]:'';}
function generateCBCampaignAdder(campaign,pre){return function(){var form=$(this);for(field in campaign){if(campaign[field]!=""){var inField=pre+field;var $formField=form.find('input[name='+inField+']');if($formField.length>0){$formField.attr('value',campaign[field]);}
else{var s=field;var input=$('<input>');input.attr('type','hidden');input.attr('name',pre+s);input.attr('value',campaign[field]);form.append(input);}}}};}})();